<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title><%= title %> · Kudos 8‑bit</title>
  <link rel="icon" href="/favicon.ico"/>
  <link rel="stylesheet" href="/css/board.css"/>
  <meta name="color-scheme" content="dark light"/>
</head>
<body class="<%= currentUser ? 'logged-in' : 'guest' %>">
<header class="header">
  <div class="brand">
    <img src="/kudos.svg" alt="Kudos Logo" class="logo">
    <a href="/" class="brand-link">openSUSE Kudos</a>
  </div>
  <nav>
    <% if (authMode === 'LOCAL') { %>
      <% if (currentUser) { %>
        <a href="/recognition/new" class="btn">➕ New Kudos</a>
        <a href="/achievements" class="btn">🏆 Achievements</a>
        <a href="/user/<%= currentUser.username %>" class="user-chip">
          <% if (currentUser.avatarUrl) { %>
            <img class="avatar" src="<%= currentUser.avatarUrl %>" alt="<%= currentUser.username %>"/>
          <% } %>
          <%= currentUser.username %>
        </a>
        <a href="/logout" class="btn">Logout</a>
      <% } else { %>
        <a href="/login" class="btn">Login</a>
      <% } %>
    <% } else { %>
      <% if (currentUser) { %>
        <a href="/recognition/new" class="btn">➕ New Kudos</a>
        <a href="/achievements" class="btn">🏆 Achievements</a>
        <span class="user-chip">
          <% if (currentUser.avatarUrl) { %>
            <img class="avatar" src="<%= currentUser.avatarUrl %>" alt="<%= currentUser.username %>"/>
          <% } %>
          <%= currentUser.username %>
        </span>
        <a href="/logout" class="btn">Logout</a>
      <% } else { %>
        <a href="/login" class="btn">Sign in with openSUSE ID</a>
      <% } %>
    <% } %>
    <button id="theme-toggle" class="theme-toggle" title="Toggle theme">🌓</button>
  </nav>
</header>


<main class="container"><%- body %></main>
<script>
  const btn = document.getElementById('theme-toggle');
  const root = document.documentElement;
  const saved = localStorage.getItem('theme');
  if (saved) root.className = saved;
  btn.onclick = () => { root.className = (root.className === 'light') ? 'dark' : 'light'; localStorage.setItem('theme', root.className); };
</script>
<script src="/js/footer.js" type="module"></script>
</body>
</html>
